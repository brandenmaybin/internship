---
title: "Clutch Work"
author: "Othon Hamill"
date: "October 24, 2018"
output: word_document
---

```{r}
#########################TO DO LIST############################
#build a function to separate the clutch points from a given data set

#Clutch Serving
  #Remove the opponent serving so just BYU is there
  #Separate the hold points and the break points

#

#How are we going to deal with deuce points being both hold and break?
```

```{r}
#call our necessary libraries
library(alr3)
library(MASS)
library(dplyr)
```

pservingonly function filters out opponents, leaving just BYU serving
```{r}
pservingonly<-function(rawdata){
  joint<-filter(rawdata,rawdata$server=="P")
}
```

highpressure function keeps only possible clutch points (a break or hold point)
```{r}
highpressure<-function(rawdata){
  #just clutch points, no sorting for server
hp<-rbind(
    rawdata[(rawdata$player.points == 0 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 1 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 2 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 2),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 1),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 0),])
  return(hp)
}
```

lowpressure function keeps everything but clutch points
```{r}
lowpressure<-function(rawdata){
  #just clutch points, no sorting for server
lp<-rawdata[(rawdata$player.points != 3 & rawdata$opp.points != 3),]
  return(lp)
}
```

acefilter: Returns all aces in a given dataset
```{r}
acefilter<-function(dataset){
  filter(dataset,dataset$serve.result=="A")
}
```

dffilter: Returns all double faults in a given dataset
```{r}
dffilter<-function(dataset){
  filter(dataset,dataset$serve.result=="D")
}
```

sclutchwins: Returns all short points won by BYU winners or opponent forced errors
```{r}
sclutchwins<-function(dataset){
  filter(dataset,dataset$point.length=="S" & dataset$point.winner=="P" & dataset$result %in% c("W","F"))
}
```

schokelosses: Returns all short points lost by opponent winners or BYU Forced errors 
Low Pressure Calculating function
```{r}
schokelosses<-function(dataset){
  filter(dataset,dataset$point.length=="S" & dataset$point.winner=="O" & dataset$result %in% c("W","F"))
}
```

Serving Scoring function
```{r}
servingscore<-function(dataset){
  clutch<-rbind(filter(dataset,dataset$point.winner=="P" & dataset$point.length=="S" & dataset$result %in% c("W","F") & dataset$server=="P"), filter(dataset, dataset$result=="A" & dataset$server=="P"))
  choke<-rbind(filter(dataset,dataset$point.winner=="O" & dataset$point.length=="S" & dataset$result %in% c("W","F") & dataset$server=="P"), filter(dataset, dataset$result=="D" & dataset$server=="P"))
  #we've got to decide values and methodology for clutch versus choke points. We've debated 1 and 0 with null ebign the mean, but at that point we just give a win percentage. What if we put null at -1?
  
  score<-c()
    
  return(score)
}
  
```


BYU Hold Point Calculating function
```{r}

```

BYU being broken Point Calculating function
```{r}

```

Opp Hold Point Calculating function
```{r}

```

Opp being broken Point Calculating function
```{r}

```

Raw Combo Calculating function
```{r}

```

Let's read in Ethan's data
```{r}
#read it in and separate out just the parts we need
ethantest<-read.csv("Ethan test.csv",header=T)[1:71,]
ethanservingdata<-(cbind(ethantest[,c(11:12,14:16,18:21,22:24)],ethantest[,32]))
ethanjoint<-as.tbl(ethanservingdata)
colnames(ethanjoint)<-c("player.sets","opp.sets","player.games","opp.games","server", "player.points", "opp.points", "serve.result", "serve.location", "return.location", "result", "point.winner", "point.length")
```

Now let's test the functions on Ethan's Data
```{r}
ethanhp<-highpressure(ethanjoint)
ethanlp<-lowpressure(ethanjoint)
ethansclutch<-sclutchwins(ethanjoint)
ethanschoke<-schokelosses(ethanjoint)

```


Just a workspace chunk
```{r}

```

