---
title: "Clutch Work"
author: "Othon Hamill"
date: "October 24, 2018"
output: word_document
---

```{r}
########################CURRENT WORK############################
#We're changing the way we weight points themselves situationally, doing weighting as described in the scoring methodology page of the google slides presentation. 


#########################TO DO LIST############################
#Weights, Whether clutch play and serves are equally valued as well as the actual values for clutch, null, and choke. 

#How are we going to deal with deuce points being both hold and break? Right now I'm including them in both, but we could just add another category since it's such a higher stress situation than a normal break or hold opprotunity :: RESOLVED WITH WEIGHTING

#How are we going to deal with returns hit into the net? 

#We need to take out possible tiebreaks since they mess with data

#We have the data properly corrected for the set set/game score corrections, but not for any possible match/set score issues 

#What the heck is the weighted combo column for?
```

```{r}
#call our necessary libraries
library(alr3)
library(MASS)
library(dplyr)
```


~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~Functions~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Set Score Corrector, for those situations where the set score doesn't get set back to 0-0 after a set is won
```{r}
SetScoreCorrector<-function(data){
  N<-dim(data)[1]
  Errors<-rep(0,times=N)
  
  #Here's our work for a win on the players side not being counted correctly
    for (i in 1:N){
        Errors[i]<- (data$player.games[i] >= 6 & data$opp.games[i] < 5)
    }
  
    #here we correct the game/set scores. We make the assumption our data has the sets correct
    data$player.games<-data$player.games-Errors*(6)
  
    return(data)
}
```



Situational Weights adds an additional column which gives a weight score for each point
40-00 gets a .3 multiplier, 40-15 a .7, 40-30 a 1.0, Deuce a 2x
4-4 and 5-5 get a x1.5 multiplier
Set Points get x2
Second Set Match Points get a x3 Multiplier
Third Set Match Points get a x3 Multiplier

5-4, 4-5, 6-5 and 5-6 gets a +1


```{r}
SituationalWeights<-function(data){
  N<-dim(data)[1]
  Multiplier<-rep(0,times=N)
  
  #Game Points by score weight
  for (i in 1:N){
    if(data$player.points[i] == 0 & data$opp.points[i] == 3){Multiplier[i]<-.3}
    if(data$opp.points[i] == 0 & data$player.points[i] == 3){Multiplier[i]<-.3}
    if(data$player.points[i] == 1 & data$opp.points[i] == 3){Multiplier[i]<-.7}
    if(data$opp.points[i] == 1 & data$player.points[i] == 3){Multiplier[i]<-.7}
    if(data$player.points[i] == 2 & data$opp.points[i] == 3){Multiplier[i]<-1}
    if(data$opp.points[i] == 2 & data$player.points[i] == 3){Multiplier[i]<-1}
    if(data$player.points[i] == 3 & data$opp.points[i] == 3){Multiplier[i]<-2}
  }
  
  #Game points under duress at 4-4 or 5-5 set score. High Pressure already keeps only game points
  for (i in 1:N){
    if(data$player.games[i] == 4 & data$opp.games[i] == 4){Multiplier[i]<-Multiplier[i]*1.5}
    if(data$opp.games[i] == 5 & data$player.games[i] == 5){Multiplier[i]<-Multiplier[i]*1.5}
  }

  #Set Points, 1st set about to be won by either or second about to be won by the loser of the first set
  for (i in 1:N){
    #opp about to win the set
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 5 & data$opp.games[i] == 6) {Multiplier[i]<-Multiplier[i]*2+1}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 4 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2+1}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 3 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 2 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 1 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 1 & data$opp.sets[i] == 0)) & data$player.games[i] == 0 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2}
    #player about to win the set
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 6 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*2+1}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 5 & data$opp.games[i] == 4) {Multiplier[i]<-Multiplier[i]*2+1}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 5 & data$opp.games[i] == 3) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 5 & data$opp.games[i] == 2) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 5 & data$opp.games[i] == 1) {Multiplier[i]<-Multiplier[i]*2}
    if(((data$player.sets[i] == 0 & data$opp.sets[i] == 0) | (data$player.sets[i] == 0 & data$opp.sets[i] == 1)) & data$player.games[i] == 5 & data$opp.games[i] == 0) {Multiplier[i]<-Multiplier[i]*2}
  }
  
  #Match Points in the second set
  for(i in 1:N){
    #player about to win
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 6 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 5 & data$opp.games[i] == 4) {Multiplier[i]<-Multiplier[i]*3+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 5 & data$opp.games[i] == 3) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 5 & data$opp.games[i] == 2) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 5 & data$opp.games[i] == 1) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 0 & data$player.games[i] == 5 & data$opp.games[i] == 0) {Multiplier[i]<-Multiplier[i]*3}
    #opponent about to win
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 6) {Multiplier[i]<-Multiplier[i]*3+1}
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 4 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3+1}
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 3 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 2 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 1 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3}
    if(data$player.sets[i] == 0 & data$opp.sets[i] == 1 & data$player.games[i] == 0 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*3}
  }
  
  #Match Points in the Third set
  for(i in 1:N){
    #player about to win
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 6 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 4) {Multiplier[i]<-Multiplier[i]*5+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 3) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 2) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 1) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 0) {Multiplier[i]<-Multiplier[i]*5}
    #opponent about to win
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 5 & data$opp.games[i] == 6) {Multiplier[i]<-Multiplier[i]*5+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 4 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5+1}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 3 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 2 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 1 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5}
    if(data$player.sets[i] == 1 & data$opp.sets[i] == 1 & data$player.games[i] == 0 & data$opp.games[i] == 5) {Multiplier[i]<-Multiplier[i]*5}
  }
  
  return(Multiplier)
}

```



pservingonly function filters out opponents, leaving just BYU serving
```{r}
pservingonly<-function(rawdata){
  joint<-filter(rawdata,rawdata$server=="P")
}
```

highpressure function keeps only possible clutch points (a break or hold point)
```{r}
highpressure<-function(rawdata){
  #just clutch points, no sorting for server
hp<-rbind(
    rawdata[(rawdata$player.points == 0 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 1 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 2 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 3),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 2),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 1),],
    rawdata[(rawdata$player.points == 3 & rawdata$opp.points == 0),])
  return(hp)
}
```

lowpressure function keeps everything but clutch points
```{r}
lowpressure<-function(rawdata){
  #just clutch points, no sorting for server
lp<-rawdata[(rawdata$player.points != 3 & rawdata$opp.points != 3),]
  return(lp)
}
```

acefilter: Returns all aces in a given dataset
```{r}
acefilter<-function(dataset){
  filter(dataset,dataset$serve.result=="A")
}
```

dffilter: Returns all double faults in a given dataset
```{r}
dffilter<-function(dataset){
  filter(dataset,dataset$serve.result=="D")
}
```

sclutchwins: Returns all short points won by BYU winners or opponent forced errors
```{r}
sclutchwins<-function(dataset){
  filter(dataset,dataset$point.length=="S" & dataset$point.winner=="P" & dataset$result %in% c("W","F"))
}
```

schokelosses: Returns all short points lost by opponent winners or BYU Forced errors 
Low Pressure Calculating function
```{r}
schokelosses<-function(dataset){
  filter(dataset,dataset$point.length=="S" & dataset$point.winner=="O" & dataset$result %in% c("W","F"))
}
```

Serving Scoring function
```{r}
servingscore<-function(dataset, W=c(1,-1,0)){
  clutch<-rbind(filter(dataset,dataset$point.winner=="P" & dataset$point.length=="S" & dataset$result %in% c("W","F") & dataset$server=="P"), filter(dataset, dataset$result=="A" & dataset$server=="P"))
  choke<-rbind(filter(dataset,dataset$point.winner=="O" & dataset$point.length=="S" & dataset$result %in% c("W","F") & dataset$server=="P"), filter(dataset, dataset$result=="D" & dataset$server=="P"))
  null<-rbind(filter(dataset, dataset$serve.result %in% c("F","S") & dataset$point.length %in% c("M","L") & dataset$server=="P"))
  #we add an if here to catch when we run the lpcolum through serving, sicne the situational weights of low pressure situations are 0. Here, if we find all the values are 0 we just use the dimensions in the calculation
  if(sum(clutch$situational.weight)+sum(choke$situational.weight)+sum(null$situational.weight) == 0){
    score<-dim(clutch)[1]*W[1]+dim(choke)[1]*W[2]+dim(null)[1]*W[3]
  }
  else{
    score<-c(sum(clutch$situational.weight)*W[1]+sum(choke$situational.weight)*W[2]+sum(null$situational.weight)*W[3])
  }
  
  return(score)
}
```

Play Scoring function
```{r}
playscore<-function(dataset, W=c(1,-1,0)){
  clutch<-filter(dataset,dataset$point.winner=="P" & dataset$result %in% c("W","F"))
  choke<-filter(dataset,dataset$point.winner=="O" & dataset$result == "U")
  null<-rbind(filter(dataset,dataset$point.winner=="P" & dataset$result == "U"), filter(dataset,dataset$point.winner=="O" & dataset$result %in% c("W","F")))
  #we can add in modifiers if we so desire here
  score<-c(sum(clutch$situational.weight)*W[1]+sum(choke$situational.weight)*W[2]+sum(null$situational.weight)*W[3])
  return(score)
}
```

Serving + Play Clutch Score
```{r}
clutchscore<-function(dataset){
  score<-playscore(dataset)+servingscore(dataset)
  return(score)
}
```


Low Pressure Column (No game points of any kind)
```{r}
lpcolumn<-function(dataset){
  lpdata<-lowpressure(dataset)
  lpservingscore<-servingscore(lpdata)
  lpplayscore<-playscore(lpdata)
  lpclutchscore<-clutchscore(lpdata)
  lpcolumn<-c(lpservingscore,lpplayscore,lpclutchscore)
  return(lpcolumn)
}
```


BYU Hold Point Calculating function
```{r}
BYUholdcolumn<-function(dataset){
  #build the BYU holding data frame including the deuce points
  byuholddf<-rbind(
    dataset[(dataset$player.points == 3 & dataset$opp.points == 3) & dataset$server== "P",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 2) & dataset$server== "P",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 1) & dataset$server== "P",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 0) & dataset$server== "P",])
  byuholdservingscore<-servingscore(byuholddf)
  byuholdplayscore<-playscore(byuholddf)
  byuholdclutchscore<-clutchscore(byuholddf)
  byuholdscores<-c(byuholdservingscore,byuholdplayscore,byuholdclutchscore)
  return(byuholdscores)
}
```

BYU being broken Point Calculating function
```{r}
BYUbreakcolumn<-function(dataset){
  #build the BYU to be broken data frame including the deuce points
  byubreakdf<-rbind(
    dataset[(dataset$player.points == 3 & dataset$opp.points == 3) & dataset$server== "P",],
    dataset[(dataset$player.points == 2 & dataset$opp.points == 3) & dataset$server== "P",],
    dataset[(dataset$player.points == 1 & dataset$opp.points == 3) & dataset$server== "P",],
    dataset[(dataset$player.points == 0 & dataset$opp.points == 3) & dataset$server== "P",])
  byubreakservingscore<-servingscore(byubreakdf)
  byubreakplayscore<-playscore(byubreakdf)
  byubreakclutchscore<-clutchscore(byubreakdf)
  byubreakscores<-c(byubreakservingscore,byubreakplayscore,byubreakclutchscore)
  return(byubreakscores)
}
```

Opp Hold Point Calculating function
```{r}
oppholdcolumn<-function(dataset){
  #build the opp holding data frame including the deuce points
  oppholddf<-rbind(
    dataset[(dataset$player.points == 3 & dataset$opp.points == 3) & dataset$server== "O",],
    dataset[(dataset$player.points == 2 & dataset$opp.points == 3) & dataset$server== "O",],
    dataset[(dataset$player.points == 1 & dataset$opp.points == 3) & dataset$server== "O",],
    dataset[(dataset$player.points == 0 & dataset$opp.points == 3) & dataset$server== "O",])
  oppholdplayscore<-playscore(oppholddf)
  oppholdclutchscore<-clutchscore(oppholddf)
  oppholdscores<-c(oppholdplayscore,oppholdclutchscore)
  return(oppholdscores)
}
```

Opp being broken Point Calculating function
```{r}
oppbreakcolumn<-function(dataset){
  #build the opp breaking data frame including the deuce points
  oppbreakdf<-rbind(
    dataset[(dataset$player.points == 3 & dataset$opp.points == 3) & dataset$server== "O",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 2) & dataset$server== "O",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 1) & dataset$server== "O",],
    dataset[(dataset$player.points == 3 & dataset$opp.points == 0) & dataset$server== "O",])
  oppbreakplayscore<-playscore(oppbreakdf)
  oppbreakclutchscore<-clutchscore(oppbreakdf)
  oppbreakscores<-c(oppbreakplayscore,oppbreakclutchscore)
  return(oppbreakscores)
}
```

Raw Combo makes the raw combo column in the clutch table. It should return a vector of 3, each with 3 elements
```{r}
rawcombo<-function(dataset){
  #read in the four pressure column situations
  BYUhold<-BYUholdcolumn(dataset)
  BYUbreak<-BYUbreakcolumn(dataset)
  opphold<-oppholdcolumn(dataset)
  oppbreak<-oppbreakcolumn(dataset)
  
  #initialize and then fill in rawcombocolumn
  rawcombocolumn<-NULL

    top<-BYUhold[1]+BYUbreak[1]
    middle<-BYUhold[2]+BYUbreak[2]+opphold[1]+oppbreak[1]
    bottom<-BYUhold[3]+BYUbreak[3]+opphold[2]+oppbreak[2]
  
  rawcombocolumn<-c(top,middle,bottom)
  return(rawcombocolumn)
}
```

The Weighted combo function takes a dataset and a weight vector of length 12 it can apply to each combination of OPP/BYU/HOLD/BREAK being clutch, choke or neutral. It doesn't account for specific high-stress points, like a match points vs. a hold point in the first set. 
```{r}
wcombo<-function(dataset,weights=c(rep(1,times=12))){
  #read in the four pressure column situations
  BYUhold<-BYUholdcolumn(dataset)
  BYUbreak<-BYUbreakcolumn(dataset)
  opphold<-oppholdcolumn(dataset)
  oppbreak<-oppbreakcolumn(dataset)
  
  #initialize and then fill in rawcombocolumn
  wcombocolumn<-NULL
  
    s<-weights[1]*unlist(BYUhold[1])[1]+weights[2]*unlist(BYUbreak[1])[1]
    p<-weights[5]*unlist(BYUhold[1])[2]+weights[6]*unlist(BYUbreak[1])[2]
    c<-weights[9]*unlist(BYUhold[1])[3]+weights[10]*unlist(BYUbreak[1])[3]
    top<-c(s,p,c)
    
    s<-weights[1]*unlist(BYUhold[2])[1]+weights[2]*unlist(BYUbreak[2])[1]+weights[3]*unlist(opphold[1])[1]+weights[4]*unlist(oppbreak[1])[1]
    p<-weights[5]*unlist(BYUhold[2])[2]+weights[6]*unlist(BYUbreak[2])[2]+weights[7]*unlist(opphold[1])[2]+weights[8]*unlist(oppbreak[1])[2]
    c<-weights[9]*unlist(BYUhold[2])[3]+weights[10]*unlist(BYUbreak[2])[3]+weights[11]*unlist(opphold[1])[3]+weights[12]*unlist(oppbreak[1])[3]
    middle<-c(s,p,c)
    
    s<-weights[1]*unlist(BYUhold[3])[1]+weights[2]*unlist(BYUbreak[3])[1]+weights[3]*unlist(opphold[2])[1]+weights[4]*unlist(oppbreak[2])[1]
    p<-weights[5]*unlist(BYUhold[3])[2]+weights[6]*unlist(BYUbreak[3])[2]+weights[7]*unlist(opphold[2])[2]+weights[8]*unlist(oppbreak[2])[2]
    c<-weights[9]*unlist(BYUhold[3])[3]+weights[10]*unlist(BYUbreak[3])[3]+weights[11]*unlist(opphold[2])[3]+weights[12]*unlist(oppbreak[2])[3]
    bottom<-c(s,p,c)
  
  wcombocolumn<-list(top,middle,bottom)
  return(wcombocolumn)
}
```


fullanalysismatrix calls all our previous functions and turns them into a matrix that looks like our table we have under clutch analysis
```{r}
FullMatrix<-function(dataset){
  #Format the Matrix
  MATRIX<-matrix(data=0,nrow=3,ncol = 7)
  rownames(MATRIX)<-c("Clutch Serving Score","Clutch Playing Score", "Overall Clutch Score")
  colnames(MATRIX)<-c("Low Pressure","BYU Hold", "BYU Break", "Opp Hold", "Opp Break", "Raw Combo", "Weighted Combo")
  
  #Make the lp matrix and do the non-clutch column
  lpdataset<-lowpressure(dataset)
  MATRIX[,1]<-c(servingscore(lpdataset),playscore(lpdataset),clutchscore(lpdataset))
  
  #Then the next 4 columns
  hpdataset<-highpressure(dataset)
  MATRIX[,2]<-BYUholdcolumn(hpdataset)
  MATRIX[,3]<-BYUbreakcolumn(hpdataset)
  MATRIX[2:3,4]<-oppholdcolumn(hpdataset)
  MATRIX[2:3,5]<-oppbreakcolumn(hpdataset)
  MATRIX[,6]<-rawcombo(hpdataset)
  return(MATRIX)
}
```

FormatData: Does all the formating we need before throwing it in FullMatrix
```{r}
FormatData<-function(RawData,DataType="Old"){
  if(DataType=="NewExcel"){
    JointData<-(cbind(RawData[,c(1,11:23,30)],rep(0,length=dim(RawData)[1])))
  }
  if(DataType=="Old"){
    JointData<-(cbind(RawData[,c(3:15,18)],rep(0,length=dim(RawData)[1])))
  }
  colnames(Data)<-c("Player.ID","player.sets","opp.sets","player.games","opp.games","server", "player.points", "opp.points", "serve.result", "serve.location", "return.location", "result", "point.winner", "point.length","situational.weight")
  JointData<-SetScoreCorrector(JointData)
  JointData<-as.tbl(JointData)
  JointData$situational.weight<-SituationalWeights(JointData)
  return(JointData)
}

```




~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~WORKING EXAMPLES~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~``

~~~~~~~~~~~~~~~~~~~~Now's let's play with the Women's Data already collected~~~~~~~~~~~~~~``
```{r}
WData<-read.csv("WTennisStats.csv")
WServingData<-(cbind(WData[,c(3:15,18)],rep(0,length=dim(WJoint)[1])))
WJoint<-as.tbl(WServingData)
colnames(WJoint)<-c("Player.ID","player.sets","opp.sets","player.games","opp.games","server", "player.points", "opp.points", "serve.result", "serve.location", "return.location", "result", "point.winner", "point.length","situational.weight")
WJoint<-SetScoreCorrector(WJoint)
WJoint<-as.tbl(WJoint)
WJoint$situational.weight<-SituationalWeights(WJoint)


fullanalysismatrix(WJoint)

ethandata<-read.csv("Ethan Test.csv")

```

